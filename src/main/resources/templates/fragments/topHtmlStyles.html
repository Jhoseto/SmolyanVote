<div th:fragment="navbarStyles">
    <!-- ✅ CSRF Meta Tags (за всички страници) - ВИНАГИ ПЪРВО -->
    <meta name="_csrf" th:content="${_csrf.token}"/>
    <meta name="_csrf_header" th:content="${_csrf.headerName}"/>
    
    <!-- ✅ CSRF Token в JavaScript за да е достъпен навсякъде -->
    <script th:inline="javascript">
        // CSRF Token за всички JavaScript заявки
        window.CSRF_TOKEN = /*[[${_csrf.token}]]*/ '';
        window.CSRF_HEADER = /*[[${_csrf.headerName}]]*/ 'X-XSRF-TOKEN';
        
        // Функция за получаване на CSRF token (fallback към cookie ако няма)
        window.getCsrfToken = function() {
            if (window.CSRF_TOKEN) return window.CSRF_TOKEN;
            var match = document.cookie.match(/(?:^|; )XSRF-TOKEN=([^;]+)/);
            return match ? decodeURIComponent(match[1]) : null;
        };
        
        window.getCsrfHeader = function() {
            return window.CSRF_HEADER || 'X-XSRF-TOKEN';
        };
    </script>

    <!-- ✅ Google Consent Mode v2 - ПЪРВО ПРЕДИ ВСИЧКО (GDPR compliant) -->
    <script>
        // Инициализация на dataLayer и gtag функция ПРЕДИ всички други скриптове
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}

        // Първоначално всичко е DENIED - GDPR compliant
        gtag('consent', 'default', {
            'analytics_storage': 'denied',
            'ad_storage': 'denied',
            'ad_user_data': 'denied',
            'ad_personalization': 'denied',
            'functionality_storage': 'denied',
            'personalization_storage': 'denied',
            'security_storage': 'granted', // Винаги granted за необходимите бисквитки
            'wait_for_update': 500
        });
    </script>

    <!-- ✅ Favicon -->
    <link rel="icon" type="image/x-icon" href="/images/logoNew.png">

    <!-- ✅ Bootstrap Icons & Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- ========================================
         GLOBAL THEME - Universal styles for entire app
         ======================================== -->
    <link rel="stylesheet" href="/css/global-theme.css">

    <!-- ========================================
         DESKTOP CSS - Loads first (base styles)
         ======================================== -->
    <link rel="stylesheet" href="/css/navBar/animAndUtility.css">
    <link rel="stylesheet" href="/css/navBar/navbar.css">
    <link rel="stylesheet" href="/css/navBar/voteMenu.css">
    <link rel="stylesheet" href="/css/navBar/search.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/lipis/flag-icons@7.2.3/css/flag-icons.min.css"/>
    <link rel="stylesheet" href="/css/avatar.css">
    <link rel="stylesheet" href="/css/footer.css">
    <link rel="stylesheet" href="/css/loginModal.css">
    <link rel="stylesheet" href="/css/oauth-buttons.css">
    <link rel="stylesheet" href="/css/fonts.css">
    <link rel="stylesheet" href="/css/notifications.css">

    <!-- ✅ Cookie Consent CSS -->
    <link rel="stylesheet" href="/css/cookie-consent.css">

    <!-- ========================================
         MOBILE CSS - Loads AFTER desktop (overrides)
         @media queries inside ensure mobile-only
         ======================================== -->
    <link rel="stylesheet" href="/css/mobile/mobile-base.css">
    <link rel="stylesheet" href="/css/mobile/mobile-navbar.css">
    <link rel="stylesheet" href="/css/mobile/mobile-modals.css">
    <link rel="stylesheet" href="/css/mobile/mobile-forms.css">
    <link rel="stylesheet" href="/css/mobile/mobile-tables.css">
    <link rel="stylesheet" href="/css/mobile/index-mobile.css">
    <link rel="stylesheet" href="/css/mobile/carousel-mobile.css">
    <link rel="stylesheet" href="/css/mobile/publications-mobile.css">
    <link rel="stylesheet" href="/css/mobile/events-mobile.css">
    <link rel="stylesheet" href="/css/mobile/signals-mobile.css">
    <link rel="stylesheet" href="/css/mobile/profile-mobile.css">
    <link rel="stylesheet" href="/css/mobile/comments-mobile.css">
    <link rel="stylesheet" href="/css/mobile/notifications-mobile.css">
    <link rel="stylesheet" href="/css/mobile/footer-mobile.css">
    <link rel="stylesheet" href="/css/mobile/admin-mobile.css">
    
    <!-- SVMessenger CSS -->
    <link rel="stylesheet" th:href="@{/svmessenger/svmessenger.css}">

</div>
