<!DOCTYPE html>
<html lang="bg" xmlns:th="http://www.thymeleaf.org">

<!-- Comments Publications Section Fragment -->
<div th:fragment="commentsSection">
    <!-- Comment Input Section -->
    <div class="comment-input-section" th:if="${#authorization.expression('isAuthenticated()')}">
        <div class="comment-input-header">
            <div class="comment-user-avatar" id="commentUserAvatar">
                <!-- Avatar —â–µ —Å–µ –ø–æ–ø—ä–ª–Ω–∏ –æ—Ç JavaScript -->
            </div>
            <div class="comment-input-container">
                <textarea
                        id="commentTextarea"
                        class="comment-textarea"
                        placeholder="–ù–∞–ø–∏—à–µ—Ç–µ –∫–æ–º–µ–Ω—Ç–∞—Ä..."
                        rows="1"></textarea>
                <div class="comment-input-actions" id="commentInputActions" style="display: none;">
                    <div class="comment-options">
                        <button class="comment-option-btn" id="commentEmojiBtn" title="–ï–º–æ—Ç–∏–∫–æ–Ω–∏">
                            <i class="bi bi-emoji-smile"></i>
                        </button>
                    </div>
                    <div class="comment-submit-actions">
                        <button class="comment-cancel-btn" id="commentCancelBtn">–û—Ç–∫–∞–∑</button>
                        <button class="comment-submit-btn" id="commentSubmitBtn" disabled>–ö–æ–º–µ–Ω—Ç–∏—Ä–∞–π</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Emoji Picker -->
        <div class="comment-emoji-picker" id="commentEmojiPicker" style="display: none;">
            <div class="emoji-grid">
                <button class="emoji-btn" data-emoji="üòä">üòä</button>
                <button class="emoji-btn" data-emoji="üòÇ">üòÇ</button>
                <button class="emoji-btn" data-emoji="üòç">üòç</button>
                <button class="emoji-btn" data-emoji="üò≠">üò≠</button>
                <button class="emoji-btn" data-emoji="üò°">üò°</button>
                <button class="emoji-btn" data-emoji="üò±">üò±</button>
                <button class="emoji-btn" data-emoji="ü§î">ü§î</button>
                <button class="emoji-btn" data-emoji="üëç">üëç</button>
                <button class="emoji-btn" data-emoji="üëé">üëé</button>
                <button class="emoji-btn" data-emoji="‚ù§Ô∏è">‚ù§Ô∏è</button>
                <button class="emoji-btn" data-emoji="üî•">üî•</button>
                <button class="emoji-btn" data-emoji="üíØ">üíØ</button>
            </div>
        </div>

        <!-- Hidden file input -->
        <input type="file" id="commentImageInput" accept="image/*" style="display: none;">
    </div>

    <!-- Login Prompt for Guests -->
    <div class="comment-login-prompt" th:if="${#authorization.expression('!isAuthenticated()')}">
        <div class="login-prompt-content">
            <i class="bi bi-person-circle"></i>
            <p>–í–ª–µ–∑—Ç–µ –≤ –ø—Ä–æ—Ñ–∏–ª–∞ —Å–∏ –∑–∞ –¥–∞ –∫–æ–º–µ–Ω—Ç–∏—Ä–∞—Ç–µ</p>
            <div class="login-prompt-actions">
                <a href="#" data-bs-toggle="modal" data-bs-target="#loginModal" class="comment-login-btn">–í—Ö–æ–¥</a>
                <a href="/register" class="comment-register-btn">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</a>
            </div>
        </div>
    </div>

    <!-- Comments List -->
    <div class="comments-container">
        <!-- Comments Header with Toggle -->
        <div class="comments-toggle-header" id="commentsToggleHeader">
            <button class="comments-toggle-btn" id="commentsToggleBtn">
                <i class="bi bi-chevron-down"></i>
                <span>–°–∫—Ä–∏–π –∫–æ–º–µ–Ω—Ç–∞—Ä–∏—Ç–µ</span>
            </button>
        </div>

        <div class="comments-list" id="commentsList">
            <!-- Comments —â–µ —Å–µ –∑–∞—Ä–µ–∂–¥–∞—Ç –¥–∏–Ω–∞–º–∏—á–Ω–æ –æ—Ç JavaScript -->

            <!-- Loading Indicator -->
            <div class="comments-loading" id="commentsLoading" style="display: none;">
                <div class="comments-spinner">
                    <div class="spinner-border spinner-border-sm" role="status">
                        <span class="visually-hidden">–ó–∞—Ä–µ–∂–¥–∞–Ω–µ...</span>
                    </div>
                    <span>–ó–∞—Ä–µ–∂–¥–∞–Ω–µ –Ω–∞ –∫–æ–º–µ–Ω—Ç–∞—Ä–∏...</span>
                </div>
            </div>

            <!-- No Comments Message -->
            <div class="no-comments-message" id="noCommentsMessage" style="display: none;">
                <div class="no-comments-content">
                    <i class="bi bi-chat-dots"></i>
                    <h4>–í—Å–µ –æ—â–µ –Ω—è–º–∞ –∫–æ–º–µ–Ω—Ç–∞—Ä–∏</h4>
                    <p th:if="${#authorization.expression('isAuthenticated()')}">–ë—ä–¥–µ—Ç–µ –ø—ä—Ä–≤–∏—è—Ç, –∫–æ–π—Ç–æ —â–µ –∫–æ–º–µ–Ω—Ç–∏—Ä–∞!</p>
                    <p th:if="${#authorization.expression('!isAuthenticated()')}">–í–ª–µ–∑—Ç–µ –≤ –ø—Ä–æ—Ñ–∏–ª–∞ —Å–∏ –∑–∞ –¥–∞ –∫–æ–º–µ–Ω—Ç–∏—Ä–∞—Ç–µ.</p>
                </div>
            </div>

            <!-- Error Message -->
            <div class="comments-error" id="commentsError" style="display: none;">
                <div class="error-content">
                    <i class="bi bi-exclamation-triangle"></i>
                    <h4>–í—ä–∑–Ω–∏–∫–Ω–∞ –≥—Ä–µ—à–∫–∞</h4>
                    <p>–ù–µ —É—Å–ø—è—Ö–º–µ –¥–∞ –∑–∞—Ä–µ–¥–∏–º –∫–æ–º–µ–Ω—Ç–∞—Ä–∏—Ç–µ.</p>
                    <button class="retry-comments-btn" id="retryCommentsBtn">–û–ø–∏—Ç–∞–π –æ—Ç–Ω–æ–≤–æ</button>
                </div>
            </div>

            <!-- Load More Comments -->
            <div class="load-more-comments" id="loadMoreComments" style="display: none;">
                <button class="load-more-btn" id="loadMoreBtn">
                    –ü–æ–∫–∞–∂–∏ –æ—â–µ –∫–æ–º–µ–Ω—Ç–∞—Ä–∏
                </button>
            </div>
        </div>
    </div>

    <!-- Comment Template (Hidden) -->
    <template id="commentTemplate">
        <div class="comment-item" data-comment-id="">
            <div class="comment-main">
                <div class="comment-avatar">
                    <!-- Avatar —â–µ —Å–µ –ø–æ–ø—ä–ª–Ω–∏ –æ—Ç JavaScript -->
                </div>
                <div class="comment-content">
                    <div class="comment-bubble">
                        <div class="comment-header">
                            <a href="#" class="comment-author"></a>
                            <span class="comment-time"></span>
                            <i class="bi bi-circle comment-online-status"></i>
                        </div>
                        <div class="comment-text"></div>
                    </div>
                    <div class="comment-actions">
                        <button class="comment-action-btn comment-like-btn">
                            <i class="bi bi-hand-thumbs-up"></i>
                            <span class="comment-likes-count">0</span>
                        </button>
                        <button class="comment-action-btn comment-dislike-btn">
                            <i class="bi bi-hand-thumbs-down"></i>
                            <span class="comment-dislikes-count">0</span>
                        </button>
                        <button class="comment-action-btn comment-reply-btn">
                            –û—Ç–≥–æ–≤–æ—Ä–∏
                        </button>
                        <span class="comment-time-separator">‚Ä¢</span>
                        <span class="comment-full-time"></span>
                        <button class="comment-action-btn comment-menu-btn">
                            <i class="bi bi-three-dots"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Comment Menu (Owner only) -->
            <div class="comment-menu-dropdown" style="display: none;">
                <button class="comment-menu-item edit-comment-btn">
                    <i class="bi bi-pencil"></i> –†–µ–¥–∞–∫—Ç–∏—Ä–∞–π
                </button>
                <button class="comment-menu-item delete-comment-btn text-danger">
                    <i class="bi bi-trash"></i> –ò–∑—Ç—Ä–∏–π
                </button>
            </div>

            <!-- Reply Input (Hidden by default) -->
            <div class="reply-input-section" style="display: none;">
                <div class="reply-input-container">
                    <div class="reply-user-avatar">
                        <!-- Avatar —â–µ —Å–µ –ø–æ–ø—ä–ª–Ω–∏ –æ—Ç JavaScript -->
                    </div>
                    <div class="reply-input-wrapper">
                        <textarea class="reply-textarea" placeholder="–ù–∞–ø–∏—à–µ—Ç–µ –æ—Ç–≥–æ–≤–æ—Ä..." rows="1"></textarea>
                        <div class="reply-actions">
                            <button class="reply-cancel-btn">–û—Ç–∫–∞–∑</button>
                            <button class="reply-submit-btn" disabled>–û—Ç–≥–æ–≤–æ—Ä–∏</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Replies List -->
            <div class="replies-list" style="display: none;">
                <!-- Replies —â–µ —Å–µ –∑–∞—Ä–µ–∂–¥–∞—Ç –¥–∏–Ω–∞–º–∏—á–Ω–æ -->
            </div>

            <!-- Replies Controls -->
            <div class="replies-controls">
                <!-- Show Replies Button (shown when replies exist but are hidden) -->
                <button class="show-replies-btn" style="display: none;">
                    <i class="bi bi-corner-down-right"></i>
                    –ü–æ–∫–∞–∂–∏ <span class="replies-count">0</span> –æ—Ç–≥–æ–≤–æ—Ä–∞
                </button>

                <!-- Hide Replies Button (shown when replies are visible) -->
                <button class="hide-replies-btn" style="display: none;">
                    <i class="bi bi-corner-down-right"></i>
                    –°–∫—Ä–∏–π –æ—Ç–≥–æ–≤–æ—Ä–∏—Ç–µ
                </button>

                <!-- Load More Replies (when there are more replies to load) -->
                <button class="load-more-replies-btn" style="display: none;">
                    –ü–æ–∫–∞–∂–∏ –æ—â–µ <span class="remaining-replies-count">0</span> –æ—Ç–≥–æ–≤–æ—Ä–∞
                </button>
            </div>

            <!-- Edit Comment Form (Hidden by default) -->
            <div class="edit-comment-form" style="display: none;">
                <div class="edit-input-container">
                    <textarea class="edit-comment-textarea" rows="2"></textarea>
                    <div class="edit-comment-actions">
                        <button class="edit-cancel-btn">–û—Ç–∫–∞–∑</button>
                        <button class="edit-save-btn">–ó–∞–ø–∞–∑–∏</button>
                    </div>
                </div>
            </div>
        </div>
    </template>

    <!-- Reply Template (Hidden) -->
    <template id="replyTemplate">
        <div class="reply-item" data-reply-id="">
            <div class="reply-main">
                <div class="reply-avatar">
                    <!-- Avatar —â–µ —Å–µ –ø–æ–ø—ä–ª–Ω–∏ –æ—Ç JavaScript -->
                </div>
                <div class="reply-content">
                    <div class="reply-bubble">
                        <div class="reply-header">
                            <a href="#" class="reply-author"></a>
                            <span class="reply-time"></span>
                            <i class="bi bi-circle reply-online-status"></i>
                        </div>
                        <div class="reply-text"></div>
                    </div>
                    <div class="reply-actions">
                        <button class="reply-action-btn reply-like-btn">
                            <i class="bi bi-hand-thumbs-up"></i>
                            <span class="reply-likes-count">0</span>
                        </button>
                        <button class="reply-action-btn reply-dislike-btn">
                            <i class="bi bi-hand-thumbs-down"></i>
                            <span class="reply-dislikes-count">0</span>
                        </button>
                        <span class="reply-time-separator">‚Ä¢</span>
                        <span class="reply-full-time"></span>
                        <button class="reply-action-btn reply-menu-btn">
                            <i class="bi bi-three-dots"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Reply Menu (Owner only) -->
            <div class="reply-menu-dropdown" style="display: none;">
                <button class="reply-menu-item edit-reply-btn">
                    <i class="bi bi-pencil"></i> –†–µ–¥–∞–∫—Ç–∏—Ä–∞–π
                </button>
                <button class="reply-menu-item delete-reply-btn text-danger">
                    <i class="bi bi-trash"></i> –ò–∑—Ç—Ä–∏–π
                </button>
            </div>

            <!-- Edit Reply Form (Hidden by default) -->
            <div class="edit-reply-form" style="display: none;">
                <div class="edit-reply-container">
                    <textarea class="edit-reply-textarea" rows="1"></textarea>
                    <div class="edit-reply-actions">
                        <button class="edit-reply-cancel-btn">–û—Ç–∫–∞–∑</button>
                        <button class="edit-reply-save-btn">–ó–∞–ø–∞–∑–∏</button>
                    </div>
                </div>
            </div>
        </div>
    </template>
</div>

</html>